================================================================================
FETCHING META (2016-2021) FOR HOLIDAYS FOLDER
INCLUDING ALL WEEKS - NO 3RD FRIDAY EXCLUSION
================================================================================

ğŸ“‹ Loading environment variables...
âœ… Environment variables loaded

ğŸ”Œ Connecting to DuckDB...
âœ… DuckDB connected

ğŸŒ Enabling S3 support...
âœ… S3 support enabled

ğŸ“¦ Loading helper functions...
âœ… Helper functions loaded

ğŸ” Testing S3 connection...
âœ… S3 connection test successful

================================================================================
PROCESSING META 2016
================================================================================

ğŸ“… Market holidays for 2016:
   All holidays: 9
   Monday holidays: 6
   Thursday holidays: 1
   Friday holidays: 2

ğŸ“¥ Loading data from S3 for 2016...
   âœ… Table options_2016_META_holidays already exists with 141,768 rows

ğŸ”§ Processing data for 2016...
   Loaded 141,768 rows
   Parsing option tickers...
   Filtering to META only (excluding FB)...
   âœ… Filtered from 141,768 to 0 rows (META only)
   âš ï¸  No META data for 2016, skipping...

================================================================================
PROCESSING META 2017
================================================================================

ğŸ“… Market holidays for 2017:
   All holidays: 9
   Monday holidays: 6
   Thursday holidays: 1
   Friday holidays: 1

ğŸ“¥ Loading data from S3 for 2017...
   âœ… Table options_2017_META_holidays already exists with 141,493 rows

ğŸ”§ Processing data for 2017...
   Loaded 141,493 rows
   Parsing option tickers...
   Filtering to META only (excluding FB)...
   âœ… Filtered from 141,493 to 0 rows (META only)
   âš ï¸  No META data for 2017, skipping...

================================================================================
PROCESSING META 2018
================================================================================

ğŸ“… Market holidays for 2018:
   All holidays: 9
   Monday holidays: 5
   Thursday holidays: 1
   Friday holidays: 1

ğŸ“¥ Loading data from S3 for 2018...
   âœ… Table options_2018_META_holidays already exists with 186,964 rows

ğŸ”§ Processing data for 2018...
   Loaded 186,964 rows
   Parsing option tickers...
   Filtering to META only (excluding FB)...
   âœ… Filtered from 186,964 to 0 rows (META only)
   âš ï¸  No META data for 2018, skipping...

================================================================================
PROCESSING META 2019
================================================================================

ğŸ“… Market holidays for 2019:
   All holidays: 9
   Monday holidays: 4
   Thursday holidays: 2
   Friday holidays: 1

ğŸ“¥ Loading data from S3 for 2019...
   ğŸ” Finding files for 2019...
   âœ… Found 252 files
   â³ Reading and aggregating files (filtering for FB/META)...
   âœ… Finished reading files (took 114.7 seconds)
   âœ… Loaded 163,833 rows

ğŸ”§ Processing data for 2019...
   Loaded 163,833 rows
   Parsing option tickers...
   Filtering to META only (excluding FB)...
   âœ… Filtered from 163,833 to 0 rows (META only)
   âš ï¸  No META data for 2019, skipping...

================================================================================
PROCESSING META 2020
================================================================================

ğŸ“… Market holidays for 2020:
   All holidays: 9
   Monday holidays: 4
   Thursday holidays: 1
   Friday holidays: 3

ğŸ“¥ Loading data from S3 for 2020...
   ğŸ” Finding files for 2020...
   âœ… Found 253 files
   â³ Reading and aggregating files (filtering for FB/META)...
   âœ… Finished reading files (took 130.8 seconds)
   âœ… Loaded 254,516 rows

ğŸ”§ Processing data for 2020...
   Loaded 254,516 rows
   Parsing option tickers...
   Filtering to META only (excluding FB)...
   âœ… Filtered from 254,516 to 0 rows (META only)
   âš ï¸  No META data for 2020, skipping...

================================================================================
PROCESSING META 2021
================================================================================

ğŸ“… Market holidays for 2021:
   All holidays: 9
   Monday holidays: 5
   Thursday holidays: 1
   Friday holidays: 3

ğŸ“¥ Loading data from S3 for 2021...
   ğŸ” Finding files for 2021...
   âœ… Found 252 files
   â³ Reading and aggregating files (filtering for FB/META)...
   âœ… Finished reading files (took 194.2 seconds)
   âœ… Loaded 309,477 rows

ğŸ”§ Processing data for 2021...
   Loaded 309,477 rows
   Parsing option tickers...
   Filtering to META only (excluding FB)...
   âœ… Filtered from 309,477 to 3,813 rows (META only)
   Filtered to calls: 2,790 rows
   Filtered to 2021: 2,790 rows
   Filtered to weekly options (Thursday and Friday expirations): 2,790 rows

ğŸ“Š Applying holiday filtering...
   Rule 1: Normal Monday-Friday entries...
   âœ… Normal Monday-Friday: 22 rows
   Rule 2: Monday-Thursday entries (Friday holiday)...
   âœ… Monday-Thursday (Friday holiday): 0 rows
   Rule 3: Tuesday-Friday entries (Monday holiday)...
   âœ… Tuesday-Friday (Monday holiday): 0 rows

ğŸ“Š Combining entries...
   âœ… Total entries: 22

ğŸ”§ Dividing prices by 4...

ğŸ“ˆ Matching with historical stock prices...
ğŸ“ˆ Loading stock prices from /Users/paulvanmierlo/spout-optionsbacktest/python-boilerplate/data/META/HistoricalData_META.csv...
   Loaded 2,515 days of stock price data
   Date range: 2016-01-04 to 2026-01-02
   Using HIGH prices for entry (pessimistic scenario)
   Using HIGH prices for expiration (pessimistic scenario)
âœ… All rows have underlying price data
   ğŸ“Š Calculating implied volatility and probability ITM...
   ğŸ”§ Rounding numeric columns...

ğŸ’¾ Saving to /Users/paulvanmierlo/spout-optionsbacktest/python-boilerplate/data/META/holidays/2021_options_pessimistic.csv (REPLACING existing file)...
âœ… Saved /Users/paulvanmierlo/spout-optionsbacktest/python-boilerplate/data/META/holidays/2021_options_pessimistic.csv
   Total rows: 22
   Unique entry dates: 4
   First date: 2021-08-16
   Last date: 2021-12-13
   All rows are META (not FB): True

================================================================================
âœ… ALL META DATA (2016-2021) FETCHED AND SAVED
================================================================================
